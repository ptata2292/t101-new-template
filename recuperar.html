<!DOCTYPE html>
<!-- saved from url=(0045)list.html.html -->
<html lang="en" data-bs-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Travel 101</title>

	<!-- Meta Tags -->
	
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Travel 101">

	<!-- Favicon -->
	<link rel="shortcut icon" href="assets/images/favicon.ico">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

	<!-- Google Font -->
	<link rel="preconnect" href="https://fonts.googleapis.com/">
	<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
	<!-- Plugins CSS -->
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/all.min.css">
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/bootstrap-icons.css">
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/flatpickr.min.css">
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/choices.min.css">
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/tiny-slider.css">
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/nouislider.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

	<!-- Theme CSS -->
	<link rel="stylesheet" type="text/css" href="https://t101-new-template.vercel.app/home_files/style.css">

<style></style></head>

<body>

<!-- **************** MAIN CONTENT START **************** -->
<main>
	
<!-- =======================
Main Content START -->
<section class="vh-xxl-100">
	<div class="container h-100 d-flex px-0 px-sm-4">
		<div class="row justify-content-center align-items-center m-auto">
			<div class="col-12">
				<div class="bg-mode shadow rounded-3 overflow-hidden">
					<div class="row g-0">
						<!-- Vector Image -->
						<div class="col-lg-6 d-flex align-items-center order-2 order-lg-1">
							<!-- <div class="p-3 p-lg-5"> -->
								<img src="../home_files/img3.jpg" alt="">
							<!-- </div>
							Divider
							<div class="vr opacity-1 d-none d-lg-block"></div> -->
						</div>
		
						<!-- Information -->
						<div class="col-lg-6 order-1">
							<div class="p-4 p-sm-7-2">
								<!-- Logo -->
									<img class="h-50px mb-4" src="../home_files/logo.png" alt="logo">
								<!-- Title -->
								<h1 class="mb-2 h3">Enter New Password</h1>
								<!-- <p class="mb-0">Enter your email address to reset password</p> -->
		
								<!-- Form START -->
								<form class="mt-4 text-start" >
									<!-- Email -->
									<div class="mb-3">
										<label class="form-label">New Password</label>
										<input type="password" id="password" class="form-control">
									</div>

									<div class="mb-3">
										<label class="form-label">Confirm Password</label>
										<input type="password" id="passwordConfirm" class="form-control">
									</div>

									<!-- Button -->
									<div><button type="button" class="btn btn-primary w-100 mb-0" onclick="confirmPassword()">Submit</button></div>
		
									<!-- Divider -->
									<div class="position-relative my-4">
										<hr>
										<p class="small bg-mode position-absolute top-50 start-50 translate-middle px-2"><a href="../index.html"> Log in</a></p>
									</div>
								</form>
								<!-- Form END -->
							</div>		
						</div>
					</div>
				</div>
				<div id="message" class="row g-0">

				</div>
			</div>
		</div>
	</div>
</section>
<!-- =======================
Main Content END -->

</main>
<!-- **************** MAIN CONTENT END **************** -->
<script>
	function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }
	var token = getParameterByName('id');
	console.log(token)

	let url = 'https://t101api.azurewebsites.net/User/validateResetPasswordAccess?id=' + token
	fetch(url, {
          headers: {
            "Content-Type": "application/json",
            'access-control-allow-origin': '*',
            // 'Authorization': 'Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im1ham9Ac3RyaWFuby5pbyIsInN1YiI6ImMzZDU0YzczLTA4MWYtNDg3OC1iOGZiLWU5ZTllOTY0MDJjYiIsIm5iZiI6MTcxNjk1NTc2NCwiZXhwIjoxNzE2OTU2MzY0LCJpYXQiOjE3MTY5NTU3NjQsImlzcyI6Iklzc3VlciIsImF1ZCI6IkF1ZGllbmNlIn0.M3s8ZAOepA78chpAUXzBaSx2cwXkiMBEBbv3tYfkoMshnHGenlTbFLa9BkESOj-K6QvZbd8hx880rMSlfYLh3A',
            // 'api_key': 'c8b129c2e8c53de7adc8e2d1ede8d5d3'
          },
          })
          .then(response => response.json())
          .then(data => {
			console.log(data)
			if (data.key !== '200') {
				let body = ''
						body += `
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<strong>${data.message}</strong> 
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						`
				document.getElementById('message').innerHTML = body	
			}
			})
          .catch(error => console.log(error))

	async function confirmPassword() {
		let password = document.getElementById('password').value
		let passwordConfirm = document.getElementById('passwordConfirm').value
		
		if (password === passwordConfirm) {
			
			let data = {
				"linkId": token,
				"newPassword": password
				}
			try {
				const response = await fetch("https://t101api.azurewebsites.net/User/updatePasswordFromReset", {
				method: "POST", 
				headers: {
					'Accept': 'application/json, text/plain, /',
					'Accept-Encoding': 'gzip, deflate, br, zstd',
					'Accept-Language': 'es-ES,es;q=0.9,en;q=0.8',
					'Authorization': 'Bearer',
					'Connection': 'keep-alive',
					'Content-Length': '94',
					'Content-Type': 'application/json',
					'Host':'t101api.azurewebsites.net',
					'Sec-Ch-Ua-Mobile':'?0',
					'Sec-Ch-Ua-Platform':"Windows",
					'Sec-Fetch-Dest':'empty',
					'Sec-Fetch-Mode':'cors',
					'Sec-Fetch-Site':'cross-site',
					'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',
					'Authorization': 'Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im1ham9Ac3RyaWFuby5pbyIsInN1YiI6ImMzZDU0YzczLTA4MWYtNDg3OC1iOGZiLWU5ZTllOTY0MDJjYiIsIm5iZiI6MTcxNjk1NTc2NCwiZXhwIjoxNzE2OTU2MzY0LCJpYXQiOjE3MTY5NTU3NjQsImlzcyI6Iklzc3VlciIsImF1ZCI6IkF1ZGllbmNlIn0.M3s8ZAOepA78chpAUXzBaSx2cwXkiMBEBbv3tYfkoMshnHGenlTbFLa9BkESOj-K6QvZbd8hx880rMSlfYLh3A',
				},
				body: JSON.stringify(data),
				});

				const result = await response.json();
				console.log("Success:", result);
				if (typeof result !== 'string') {
				let body = ''
						body += `
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<strong>${result.message}</strong> 
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						`
					document.getElementById('message').innerHTML = body	
				}
				else {
					let body = ''
						body += `
						<div class="alert alert-success alert-dismissible fade show" role="alert">
							<strong>${result.message}</strong>
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						`
					document.getElementById('message').innerHTML = body
				}				
			} catch (error) {
				console.error("Error:", error);
				let body = ''
						body += `
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<strong>${error.message}</strong> 
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						`
				document.getElementById('message').innerHTML = body
			}

		} else {
			let body = ''
						body += `
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<strong>Passwords do not match</strong>
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						`
				document.getElementById('message').innerHTML = body
		}
	}
</script>
<!-- Back to top -->
<div class="back-top"></div>

<!-- Bootstrap JS -->
<script src="https://t101-new-template.vercel.app/home_files/bootstrap.bundle.min.js.descarga"></script>

<!-- Vendors -->
<script src="https://t101-new-template.vercel.app/home_files/flatpickr.min.js.descarga"></script>
<script src="https://t101-new-template.vercel.app/home_files/choices.min.js.descarga"></script>
<script src="https://t101-new-template.vercel.app/home_files/tiny-slider.js.descarga"></script>
<script src="https://t101-new-template.vercel.app/home_files/nouislider.min.js.descarga"></script>

</body></html>